-- MySQL Script generated by MySQL Workbench
-- 12/23/14 23:08:53
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema proyecto_inr
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema proyecto_inr
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `proyecto_inr` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `proyecto_inr` ;

-- -----------------------------------------------------
-- Table `proyecto_inr`.`Rol`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Rol` (
  `idRol` CHAR(4) NOT NULL,
  `gestionarLES` TINYINT(1) NOT NULL,
  `gestionarRES` TINYINT(1) NOT NULL,
  `verificarLES` TINYINT(1) NOT NULL,
  `verificarRES` TINYINT(1) NOT NULL,
  `consultarLES` TINYINT(1) NOT NULL,
  `consultarRES` TINYINT(1) NOT NULL,
  `mantenimiento` TINYINT(1) NOT NULL,
  `reporte` TINYINT(1) NOT NULL,
  `manEmpleado` TINYINT(1) NOT NULL,
  `manUnidad` TINYINT(1) NOT NULL,
  `manCargo` TINYINT(1) NOT NULL,
  `manRol` TINYINT(1) NOT NULL,
  `manFirma` TINYINT(1) NOT NULL,
  PRIMARY KEY (`idRol`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Estado`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Estado` (
  `idEstado` INT NOT NULL,
  `descripcion` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idEstado`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Cargo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Cargo` (
  `idCargo` CHAR(5) NOT NULL,
  `descripcion` VARCHAR(45) NOT NULL,
  `sueldo` DECIMAL(9,2) NOT NULL,
  PRIMARY KEY (`idCargo`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Empleado`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Empleado` (
  `idEmpleado` CHAR(7) NOT NULL,
  `idRol` CHAR(4) NOT NULL,
  `idEstado` INT NOT NULL,
  `nombresEmpleado` VARCHAR(50) NOT NULL,
  `apellidoPaterno` VARCHAR(45) NOT NULL,
  `apellidoMaterno` VARCHAR(45) NOT NULL,
  `fechaNacimiento` DATE NOT NULL,
  `telefono` CHAR(5) NULL,
  `celular` CHAR(9) NULL,
  `numeroSeguroSocial` CHAR(11) NOT NULL,
  `usuario` VARCHAR(45) NOT NULL,
  `psswrd` VARCHAR(45) NOT NULL,
  `idCargo` CHAR(5) NOT NULL,
  `foto` BLOB NULL,
  `fechaIngresoLaboral` DATE NOT NULL,
  PRIMARY KEY (`idEmpleado`),
  INDEX `fk_Empleado_Rol1_idx` (`idRol` ASC),
  INDEX `fk_Empleado_Estado1_idx` (`idEstado` ASC),
  INDEX `fk_Empleado_Cargo1_idx` (`idCargo` ASC),
  CONSTRAINT `fk_Empleado_Rol1`
    FOREIGN KEY (`idRol`)
    REFERENCES `proyecto_inr`.`Rol` (`idRol`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Empleado_Estado1`
    FOREIGN KEY (`idEstado`)
    REFERENCES `proyecto_inr`.`Estado` (`idEstado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Empleado_Cargo1`
    FOREIGN KEY (`idCargo`)
    REFERENCES `proyecto_inr`.`Cargo` (`idCargo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Director`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Director` (
  `idDirector` CHAR(7) NOT NULL,
  `a√±osExperiencia` INT NOT NULL,
  INDEX `fk_Director_Empleado_idx` (`idDirector` ASC),
  PRIMARY KEY (`idDirector`),
  CONSTRAINT `fk_Director_Empleado`
    FOREIGN KEY (`idDirector`)
    REFERENCES `proyecto_inr`.`Empleado` (`idEmpleado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`LES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`LES` (
  `idLES` CHAR(7) NOT NULL,
  `idDirector` CHAR(7) NULL,
  `idEmpleado` CHAR(7) NOT NULL,
  `idEstado` INT NOT NULL,
  `diagnosticoMedico` TEXT(200) NOT NULL,
  `fechaInicioDescanso` DATE NOT NULL,
  `fechaFinDescanso` DATE NOT NULL,
  `documentoDM` LONGBLOB NOT NULL,
  `motivoLicencia` VARCHAR(100) NOT NULL,
  `descripcionMotivo` TEXT(500) NOT NULL,
  `fechaHoraGenerar` DATETIME NOT NULL,
  PRIMARY KEY (`idLES`),
  INDEX `fk_LES_Director1_idx` (`idDirector` ASC),
  INDEX `fk_LES_Empleado1_idx` (`idEmpleado` ASC),
  INDEX `fk_LES_Estado1_idx` (`idEstado` ASC),
  CONSTRAINT `fk_LES_Director1`
    FOREIGN KEY (`idDirector`)
    REFERENCES `proyecto_inr`.`Director` (`idDirector`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LES_Empleado1`
    FOREIGN KEY (`idEmpleado`)
    REFERENCES `proyecto_inr`.`Empleado` (`idEmpleado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LES_Estado1`
    FOREIGN KEY (`idEstado`)
    REFERENCES `proyecto_inr`.`Estado` (`idEstado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`UnidadOrganica`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`UnidadOrganica` (
  `idUnidadOrganica` CHAR(6) NOT NULL,
  `idDirector` CHAR(7) NOT NULL,
  `nombreUnidadOrganica` VARCHAR(100) NOT NULL,
  `direccion` TEXT(200) NOT NULL,
  PRIMARY KEY (`idUnidadOrganica`),
  INDEX `fk_UnidadOrganica_Director1_idx` (`idDirector` ASC),
  CONSTRAINT `fk_UnidadOrganica_Director1`
    FOREIGN KEY (`idDirector`)
    REFERENCES `proyecto_inr`.`Director` (`idDirector`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Equipo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Equipo` (
  `idEquipo` CHAR(6) NOT NULL,
  `nombreEquipo` VARCHAR(60) NOT NULL,
  `idUnidadOrganica` CHAR(6) NOT NULL,
  `descripcion` TEXT(300) NOT NULL,
  PRIMARY KEY (`idEquipo`),
  INDEX `fk_Equipo_UnidadOrganica1_idx` (`idUnidadOrganica` ASC),
  CONSTRAINT `fk_Equipo_UnidadOrganica1`
    FOREIGN KEY (`idUnidadOrganica`)
    REFERENCES `proyecto_inr`.`UnidadOrganica` (`idUnidadOrganica`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Tecnico`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Tecnico` (
  `idTecnico` CHAR(7) NOT NULL,
  `funcion` TEXT(100) NOT NULL,
  `especialidad` VARCHAR(45) NOT NULL,
  `idEquipo` CHAR(6) NOT NULL,
  `idTecnico_Jefe` CHAR(7) NOT NULL,
  INDEX `fk_Tecnico_Empleado1_idx` (`idTecnico` ASC),
  PRIMARY KEY (`idTecnico`),
  INDEX `fk_Tecnico_Equipo1_idx` (`idEquipo` ASC),
  INDEX `fk_Tecnico_Tecnico1_idx` (`idTecnico_Jefe` ASC),
  CONSTRAINT `fk_Tecnico_Empleado1`
    FOREIGN KEY (`idTecnico`)
    REFERENCES `proyecto_inr`.`Empleado` (`idEmpleado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Tecnico_Equipo1`
    FOREIGN KEY (`idEquipo`)
    REFERENCES `proyecto_inr`.`Equipo` (`idEquipo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Tecnico_Tecnico1`
    FOREIGN KEY (`idTecnico_Jefe`)
    REFERENCES `proyecto_inr`.`Tecnico` (`idTecnico`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`RES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`RES` (
  `idRES` CHAR(7) NOT NULL,
  `idLES` CHAR(7) NOT NULL,
  `idEstado` INT NOT NULL,
  `idTecnico_Generador` CHAR(7) NOT NULL,
  `referencia` TEXT(200) NOT NULL,
  `descriptor` TEXT(500) NOT NULL,
  `objetodeConsulta` TEXT(5000) NOT NULL,
  `analisis` TEXT(5000) NOT NULL,
  `fechaHoraGenerar` DATETIME NOT NULL,
  `urlVer` VARCHAR(100) NOT NULL,
  `urlCom` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`idRES`),
  INDEX `fk_RES_LES1_idx` (`idLES` ASC),
  INDEX `fk_RES_Estado1_idx` (`idEstado` ASC),
  INDEX `fk_RES_Tecnico1_idx` (`idTecnico_Generador` ASC),
  CONSTRAINT `fk_RES_LES1`
    FOREIGN KEY (`idLES`)
    REFERENCES `proyecto_inr`.`LES` (`idLES`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_RES_Estado1`
    FOREIGN KEY (`idEstado`)
    REFERENCES `proyecto_inr`.`Estado` (`idEstado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_RES_Tecnico1`
    FOREIGN KEY (`idTecnico_Generador`)
    REFERENCES `proyecto_inr`.`Tecnico` (`idTecnico`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `proyecto_inr`.`Director_RES`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `proyecto_inr`.`Director_RES` (
  `idDirector` CHAR(7) NOT NULL,
  `idRES` CHAR(7) NOT NULL,
  `fechaHoraAprobacion` DATETIME NOT NULL,
  `firmaDirectoEjecutivo` BLOB NULL,
  `firmaDirectorPersonal` BLOB NULL,
  PRIMARY KEY (`idDirector`, `idRES`),
  INDEX `fk_Director_has_RES_RES1_idx` (`idRES` ASC),
  INDEX `fk_Director_has_RES_Director1_idx` (`idDirector` ASC),
  CONSTRAINT `fk_Director_has_RES_Director1`
    FOREIGN KEY (`idDirector`)
    REFERENCES `proyecto_inr`.`Director` (`idDirector`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Director_has_RES_RES1`
    FOREIGN KEY (`idRES`)
    REFERENCES `proyecto_inr`.`RES` (`idRES`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
